<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script>
  // Terminal animation (existing)
  const terminal = document.getElementById('terminalOutput');
  const lines = [
    '> Boot sequence complete.',
    '> Connection established.',
    '> Identity verification required...',
    '> Awaiting user authentication.'
  ];
  let i = 0;
  function typeLine() {
    if (i < lines.length) {
      const line = document.createElement('div');
      line.textContent = lines[i++];
      terminal.appendChild(line);
      setTimeout(typeLine, 900);
    }
  }
  setTimeout(() => {
    terminal.innerHTML = ''; // clear initial line
    typeLine();
  }, 1500);

  // --- Login functionality ---
  const firebaseConfig = {
    apiKey: "AIzaSyCKtIkEDVF8lVE2cyuvft5S4urfN6JKthQ",
    authDomain: "portfolio-website-e44c0.firebaseapp.com",
    projectId: "portfolio-website-e44c0",
    storageBucket: "portfolio-website-e44c0.appspot.com",
    messagingSenderId: "804676117496",
    appId: "1:804676117496:web:53d4acf4ec154535f2ec0d",
    measurementId: "G-CK458DNT87"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const googleProvider = new firebase.auth.GoogleAuthProvider();
  const githubProvider = new firebase.auth.GithubAuthProvider();

  async function verifyWithBackend(user) {
    try {
      const idToken = await user.getIdToken();
      const response = await fetch('http://localhost:5000/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ idToken })
      });
      const data = await response.json();
      if (!data.success) {
        await auth.signOut();
        alert('Access Denied by server.');
        return false;
      }
      return true;
    } catch (err) {
      alert('Verification failed: ' + err.message);
      return false;
    }
  }

  document.getElementById('googleLogin').onclick = async function() {
    try {
      const result = await auth.signInWithPopup(googleProvider);
      const ok = await verifyWithBackend(result.user);
      if (ok) window.location.href = 'index.html';
    } catch (err) {
      alert('Login failed: ' + err.message);
    }
  };
  document.getElementById('githubLogin').onclick = async function() {
    try {
      const result = await auth.signInWithPopup(githubProvider);
      const ok = await verifyWithBackend(result.user);
      if (ok) window.location.href = 'index.html';
    } catch (err) {
      alert('Login failed: ' + err.message);
    }
  };
</script> 